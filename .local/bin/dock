#!/bin/bash

main () {
    if [ ! -n "$1" ]; then
        help
    fi

    while [ -n "$1" ]; do # while loop starts
        case "$1" in
            -d) 
                dock; break ;;
            -u) 
                undock; break ;;
            -h|--help)
                help ;;
            *) 
                usage; echo "error: unrecognized arguments: $1" ; exit 1 ;;
        esac
        shift
    done
}

usage () {
    echo "usage: dock [options]"
}

help () {
    usage
    echo
    echo "Dock or undock laptop"
    echo
    echo "options:"
    echo "  -h, --help            show this help message and exit"
    echo "  -d                    dock"
    echo "  -u                    undock"
}

dock () { 
    if ! xrandr | grep -q "HDMI-1 connected" ; then
        echo "error: HDMI not connected"; exit 1
    fi

    barpos -b
    xrandr --output HDMI-1 --mode 2560x1440 --rate 70 --primary
    xrandr --output eDP-1 --off 
    xwallpaper --center $XDG_CONFIG_HOME/wallpaper/bg 
    betterlockscreen -u $XDG_CONFIG_HOME/wallpaper/lock &>/dev/null &
}

undock () {
    barpos -t
    xrandr --output eDP-1 --mode 1920x1080 --primary
    xrandr --output HDMI-1 --off
    xwallpaper --center $XDG_CONFIG_HOME/wallpaper/bg 
    betterlockscreen -u $XDG_CONFIG_HOME/wallpaper/lock &>/dev/null &
}

main "$@"
